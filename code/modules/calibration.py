calibration_0 = {
    'zero':135, 
    'calibration':{
   -105: -105,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -45,
    -30: -30,
    -15: -15,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 105
    }
}

calibration_o01 = {
    'zero':132, 
    'calibration':{
    -90: -93,
    -75: -78,
    -60: -62,
    -45: -45,
    -30: -30,
    -25: -24,
    -15: -14,
      0: 0,
     15: 12.5,
     30: 26,
     45: 41,
     60: 56.5,
     75: 72.5,
     90: 88.5
    }
}

calibration_o02 = {
    'zero':138, 
    'calibration':{
   -105: -107,
    -90: -90,
    -85: -83.5,
    -75: -74,
    -60: -57.5,
    -45: -42.5,
    -30: -27,
    -15: -13,
    -10: -8,
      0: 0,
     15: 14,
     30: 28,
     45: 44,
     60: 60,
     75: 76.5,
     90: 92
    }
}

calibration_o03 = {
    'zero':140, 
    'calibration':{
   -105: -101,
    -90: -85,
    -75: -70,
    -60: -55,
    -45: -40,
    -30: -26,
    -15: -12.5,
      0: 0,
     15: 14,
     30: 27.5,
     45: 43,
     60: 57,
     75: 72,
     90: 87,
    105: 103.5
    }
}

calibration_o04 = {
    'zero':140, 
    'calibration':{
   -105: -105,
    -90: -88,
    -75: -72.5,
    -60: -56.5,
    -45: -42.5,
    -30: -27,
    -15: -12.5,
      0: 0,
     15: 13,
     30: 27,
     45: 42,
     60: 58,
     75: 73,
     85: 83,
     90: 89,
    105: 105
    }
}

calibration_o05 = {
    'zero':130.5, 
    'calibration':{
   -105: -101,
    -90: -85,
    -85: -81,
    -75: -70,
    -60: -55,
    -45: -41,
    -30: -25,
    -15: -12,
      0: 0,
     15: 13,
     30: 26,
     45: 41.5,
     60: 57,
     75: 74,
     90: 90,
    105: 108
    }
}

calibration_o06 = {
    'zero':139, 
    'calibration':{
   -105: -103,
    -90: -86,
    -75: -72,
    -60: -56,
    -45: -41,
    -30: -27,
    -15: -13,
      0: 0,
     15: 15,
     30: 29,
     45: 43.5,
     60: 58,
     75: 73,
     90: 88.5,
    105: 105
    }
}

calibration_o07 = {
    'zero':137, 
    'calibration':{
   -105: -103,
    -90: -88,
    -75: -74,
    -60: -58.5,
    -45: -43.5,
    -30: -28,
    -15: -13.5,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 61,
     75: 75,
     90: 93,
    105: 110
    }
}

calibration_o08 = {
    'zero':132, 
    'calibration':{
   -105: -105,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -45,
    -30: -30,
    -15: -15,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 105
    }
}

calibration_o09 = {
    'zero':140, 
    'calibration':{
   -105: -105,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -45,
    -30: -30,
    -15: -15,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 105
    }
}

calibration_o10 = {
    'zero':135, 
    'calibration':{
   -105: -105,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -45,
    -30: -30,
    -15: -15,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 105
    }
}

calibration_o11 = {
    'zero':135, 
    'calibration':{
   -105: -105,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -45,
    -30: -30,
    -15: -15,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 105
    }
}
"""
calibration_o08 = {
    'zero':141.5, 
    'calibration':{
   -105: -102,
    -90: -86,
    -75: -71,
    -60: -55,
    -45: -41,
    -30: -26,
    -15: -13.5,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 61,
     75: 77.5,
     90: 94,
    105: 111
    }
}

calibration_o09 = {
    'zero':136, 
    'calibration':{
   -105: -102.5,
    -90: -86,
    -75: -71,
    -60: -57,
    -45: -42,
    -30: -27,
    -15: -13,
      0: 0,
     15: 14,
     30: 28,
     45: 45,
     60: 60,
     75: 75,
     90: 90,
    105: 107
    }
}

calibration_o10 = {
    'zero':141, 
    'calibration':{
   -105: -105,
    -90: -87.5,
    -75: -72.5,
    -60: -57,
    -45: -42,
    -30: -27,
    -15: -13,
      0: 0,
     15: 15,
     30: 30,
     45: 45,
     60: 60,
     75: 77,
     90: 93,
    105: 110
    }
}

calibration_o11 = {
    'zero':141, 
    'calibration':{
   -105: -100,
    -90: -85,
    -75: -70,
    -60: -55,
    -45: -41,
    -30: -26,
    -15: -13,
      0: 0,
     15: 13,
     30: 28,
     45: 42,
     60: 57,
     75: 73,
     90: 90,
    105: 105
    }
}
"""
calibration_o12 = {
    'zero':138, 
    'calibration':{
   -105: -106,
    -90: -90,
    -75: -75,
    -60: -58,
    -45: -44,
    -30: -29,
    -15: -14,
      0: 0,
     15: 14.5,
     30: 28,
     45: 43,
     60: 58,
     75: 73,
     90: 88,
    105: 105
    }
}

calibration_o13 = {
    'zero':136, 
    'calibration':{
   -105: -106,
    -90: -90,
    -75: -75,
    -60: -60,
    -45: -43,
    -30: -28,
    -15: -14,
      0: 0,
     15: 13.5,
     30: 27,
     45: 42,
     60: 60,
     75: 75,
     90: 90,
    105: 107
    }
}

calibration_o14 = {
    'zero':137.5, 
    'calibration':{
   -105: -101,
    -90: -86,
    -75: -71,
    -60: -56,
    -45: -41,
    -30: -27,
    -15: -12,
      0: 0,
     15: 12,
     30: 27,
     45: 43,
     60: 60,
     75: 76,
     90: 93,
    105: 108
    }
}

calibration_o15 = {
    'zero':138.5, 
    'calibration':{
   -105: -105,
    -90: -88,
    -75: -71,
    -60: -55,
    -45: -41,
    -30: -26,
    -15: -13,
      0: 0,
     15: 13.5,
     30: 28.5,
     45: 42.5,
     60: 58,
     75: 75,
     90: 90,
    105: 105
    }
}

calibration_o16 = {
    'zero':141, 
    'calibration':{
   -105: -101,
    -90: -87,
    -75: -72,
    -60: -57,
    -50: -46,
    -45: -42,
    -40: -36,
    -30: -28,
    -15: -14,
    0: 0,
    15: 13,
    30: 27,
    45: 44,
    60: 60,
    75: 76,
    90: 94,
    105: 110
    }
}

# (o07, o01, o02, o03, o10, o06, o05, o04, o11, o08, o09, o12, o16, o15, o13, o14)
calibration_dicts = {0 : calibration_o07, 
                     1 : calibration_o01,
                     2 : calibration_o02,
                     3 : calibration_o03,
                     4 : calibration_o10,
                     5 : calibration_o06,
                     6 : calibration_o05,
                     7 : calibration_o04,
                     8 : calibration_o11,
                     9 : calibration_o08,
                    10 : calibration_o09,
                    11 : calibration_o12,
                    12 : calibration_o16,
                    13 : calibration_o15,
                    14 : calibration_o13,
                    15 : calibration_o14}

def get_interval(calibration_dict, target_value):
    for k, v in sorted(calibration_dict.items()):
        if k > target_value:
            try:
                return (*prev_kv, k, v)
            except UnboundLocalError:
                # if target_value is less than minimum calibrated value, just extrapolate
                return (target_value, target_value * v / k, k, v)
        prev_kv = (k, v)
    # if target_value is more than maximum calibrated value, just extrapolate
    return (*prev_kv, target_value + 1, (target_value + 1) * prev_kv[1] / prev_kv[0])
	
def calculate_indent(i, target_value):
    if target_value == 0:
        return 0
    lower_border, lower_value, upper_border, upper_value = get_interval(calibration_dicts[i]['calibration'], target_value)
    pct = (target_value - lower_border) / (upper_border - lower_border)
    value_updated = (1 - pct) * lower_value + pct * upper_value
    return target_value * (target_value / value_updated)
	
def calibrate(i, target_value):
    return (round(calibration_dicts[i]['zero'] + calculate_indent(i, target_value), 4))
